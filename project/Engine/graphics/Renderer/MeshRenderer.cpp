#include "MeshRenderer.h"
#include <lib/myFunc/PrimitiveDrawer.h>
#include <lib/myMath/Matrix4x4.h>

/////////////////////////////////////////////////////////////////////////////////////////
//		描画登録
/////////////////////////////////////////////////////////////////////////////////////////
void MeshRenderer::Register(IMeshRenderable* renderable){
	renderables_.push_back(renderable);
}

/////////////////////////////////////////////////////////////////////////////////////////
//		削除
/////////////////////////////////////////////////////////////////////////////////////////
void MeshRenderer::Unregister(IMeshRenderable* renderable){
	renderables_.erase(std::remove(renderables_.begin(), renderables_.end(), renderable), renderables_.end());
}

/////////////////////////////////////////////////////////////////////////////////////////
//		描画
/////////////////////////////////////////////////////////////////////////////////////////
void MeshRenderer::DrawAll(const Matrix4x4& vp){
	for (auto* mesh : renderables_){
		if (mesh) mesh->Draw();
	}

	PrimitiveDrawer::GetInstance()->Render(vp);
}

void MeshRenderer::Clear(){
	renderables_.clear();
}
